<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P4 - Semanas 3 y 4: Relaciones y Polimorfismo</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">

    <style>
        :root {
            --pastel-blue: #ebf4f6;
            --pastel-pink: #f9f1f0;
            --pastel-green: #e8f5e9;
            --pastel-yellow: #fff9e6;
            --accent-blue: #b2d8d8;
            --text-color: #555;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background-color: var(--pastel-blue);
            color: var(--text-color);
        }

        .slide-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .card-slide {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            max-width: 850px;
            width: 100%;
            padding: 40px;
            border: none;
            display: none;
        }

        .card-slide.active {
            display: block;
        }

        .btn-pastel {
            background-color: var(--accent-blue);
            border: none;
            color: white;
            padding: 10px 25px;
            border-radius: 50px;
            transition: all 0.3s;
        }

        .btn-pastel:hover {
            background-color: #96c9c9;
            transform: scale(1.05);
        }

        .analogy-box {
            background-color: var(--pastel-yellow);
            border-left: 5px solid #f0ad4e;
            padding: 15px;
            margin-top: 20px;
            border-radius: 0 10px 10px 0;
            font-size: 0.95rem;
        }

        .nav-dots {
            position: fixed;
            bottom: 20px;
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ccc;
            cursor: pointer;
        }

        .dot.active {
            background: var(--accent-blue);
        }
        
        .swal-summary-list {
            text-align: left;
            font-size: 0.9rem;
        }
        .concept-highlight {
            background-color: var(--pastel-green);
            padding: 5px 10px;
            border-radius: 8px;
            display: inline-block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .uml-line {
            color: #4CAF50;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div class="slide-container">
    <div class="card-slide active animate__animated animate__fadeIn" id="slide0">
        <div class="text-center">
            <div class="icon-box mb-3" style="font-size: 4rem; color: var(--accent-blue);">
                <i class="fas fa-link"></i>
            </div>
            <h1 class="fw-bold">Programación 4</h1>
            <p class="lead">Semanas 3 y 4: ¡Conectando y Adaptando Objetos!</p>
            <hr class="my-4">
            <p>Descubre cómo los objetos se relacionan y cómo el código se adapta inteligentemente.</p>
            <button class="btn btn-pastel mt-3" onclick="nextSlide()">Comenzar Lección <i class="fas fa-chevron-right ms-2"></i></button>
        </div>
    </div>

    <div class="card-slide animate__animated animate__fadeIn" id="slide1">
        <h3><i class="fas fa-handshake me-2 text-primary"></i> Relaciones entre Clases</h3>
        <p>Los objetos no viven aislados; interactúan y se conectan entre sí.</p>
        <div class="p-3 mb-3 rounded" style="background-color: var(--pastel-blue);">
            <div class="concept-highlight">Asociación</div>
            <p class="mb-0">Conexión general entre dos clases. [cite_start]Una clase conoce a otra[cite: 521].</p>
            <small class="uml-line">UML: Línea sólida simple (ej: Cliente --- Pedido)</small>
        </div>
        <div class="p-3 rounded" style="background-color: var(--pastel-pink);">
            <div class="concept-highlight">Cardinalidad</div>
            <p class="mb-0">[cite_start]Cuántos objetos de una clase se relacionan con cuántos de otra[cite: 522]. Ej: 1 a muchos (1 Cliente tiene *muchos* Pedidos).</p>
            <small class="uml-line">UML: Números en los extremos de la línea (ej: Cliente "1" --- "0..*" Pedido)</small>
        </div>
        <div class="analogy-box">
            <i class="fas fa-users me-2"></i><strong>Analogía:</strong> Un estudiante y un curso están **asociados**. La **cardinalidad** dice que 1 Curso puede tener *muchos* estudiantes, y 1 estudiante puede estar en *muchos* cursos.
        </div>
        <div class="mt-4 text-center">
            <button class="btn btn-pastel" onclick="prevSlide()">Atrás</button>
            <button class="btn btn-pastel" onclick="nextSlide()">Siguiente</button>
        </div>
    </div>

    <div class="card-slide animate__animated animate__fadeIn" id="slide2">
        <h3><i class="fas fa-sitemap me-2 text-success"></i> Tipos de Composición</h3>
        <p>Hay relaciones de "parte-todo" que son muy importantes:</p>
        <div class="row">
            <div class="col-md-6">
                <div class="p-3 rounded mb-3 h-100" style="background-color: var(--pastel-green);">
                    <div class="concept-highlight">Agregación</div>
                    <p class="mb-0">[cite_start]Una clase 'tiene' otra, pero las partes pueden existir solas[cite: 530]. Es una relación "débil" de pertenencia.</p>
                    <small class="uml-line">UML: Rombo blanco en el lado del "todo" (ej: Equipo <span style="color:black">◇</span>--- Jugador)</small>
                </div>
            </div>
            <div class="col-md-6">
                <div class="p-3 rounded h-100" style="background-color: var(--pastel-blue);">
                    <div class="concept-highlight">Composición</div>
                    <p class="mb-0">[cite_start]Una clase 'contiene' otra, y las partes no tienen sentido sin el todo[cite: 530]. Es una relación "fuerte".</p>
                    <small class="uml-line">UML: Rombo negro en el lado del "todo" (ej: Motor <span style="color:black">◆</span>--- Pistón)</small>
                </div>
            </div>
        </div>
        <div class="analogy-box">
            <i class="fas fa-boxes me-2"></i><strong>Analogía:</strong> Un <span style="font-weight:bold; color:#2e7d32;">equipo de fútbol</span> tiene jugadores (Agregación: los jugadores pueden existir sin el equipo). Un <span style="font-weight:bold; color:#1565c0;">coche</span> está compuesto por un motor (Composición: el motor no funciona solo sin el coche, ni el coche sin motor).
        </div>
        <div class="mt-4 text-center">
            <button class="btn btn-pastel" onclick="prevSlide()">Atrás</button>
            <button class="btn btn-pastel" onclick="nextSlide()">Siguiente</button>
        </div>
    </div>

    <div class="card-slide animate__animated animate__fadeIn" id="slide3">
        <h3><i class="fas fa-random me-2 text-warning"></i> Polimorfismo y Despacho Dinámico</h3>
        <p>[cite_start]Polimorfismo significa "muchas formas"[cite: 318]. Permite que un objeto se comporte de distintas maneras según su tipo real, ¡aunque lo tratemos como un tipo más genérico!</p>
        <div class="p-3 rounded mb-3" style="background-color: var(--pastel-yellow);">
            <div class="concept-highlight">Despacho Dinámico</div>
            <p class="mb-0">[cite_start]Es el mecanismo que permite al programa decidir en tiempo de ejecución (mientras se ejecuta) qué versión del método debe llamar[cite: 322].</p>
        </div>
        <div class="analogy-box">
            <i class="fas fa-play me-2"></i><strong>Analogía:</strong> Imagina que tienes un botón "Reproducir". Si lo presionas en un MP3, reproduce música. Si lo presionas en un video, reproduce imágenes y sonido. El botón (método) es el mismo, pero lo que hace (comportamiento) se adapta al tipo de archivo. ¡Eso es Polimorfismo!
        </div>
        <div class="mt-4 text-center">
            <button class="btn btn-pastel" onclick="prevSlide()">Atrás</button>
            <button class="btn btn-pastel" onclick="nextSlide()">Siguiente</button>
        </div>
    </div>

    <div class="card-slide animate__animated animate__fadeIn" id="slide4">
        <div class="text-center">
            <i class="fas fa-award mb-3" style="font-size: 3rem; color: #ffca28;"></i>
            <h3>¡Desafío Semanas 3 y 4!</h3>
            <p>Pon a prueba tus conocimientos sobre relaciones y polimorfismo.</p>
            <button class="btn btn-pastel btn-lg" onclick="startQuiz()">Empezar Test</button>
            <hr>
            <button class="btn btn-link text-secondary" onclick="goToSlide(0)">Reiniciar esta lección</button>
        </div>
    </div>
</div>

<div class="nav-dots">
    <div class="dot active" onclick="goToSlide(0)"></div>
    <div class="dot" onclick="goToSlide(1)"></div>
    <div class="dot" onclick="goToSlide(2)"></div>
    <div class="dot" onclick="goToSlide(3)"></div>
    <div class="dot" onclick="goToSlide(4)"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    let currentSlide = 0;
    const totalSlides = 5;

    function updateSlides() {
        document.querySelectorAll('.card-slide').forEach((s, i) => s.classList.toggle('active', i === currentSlide));
        document.querySelectorAll('.dot').forEach((d, i) => d.classList.toggle('active', i === currentSlide));
    }

    function nextSlide() { if(currentSlide < totalSlides-1) { currentSlide++; updateSlides(); } }
    function prevSlide() { if(currentSlide > 0) { currentSlide--; updateSlides(); } }
    function goToSlide(n) { currentSlide = n; updateSlides(); }

    async function startQuiz() {
        const questions = [
            { 
                q: "¿Qué tipo de relación implica que las partes pueden existir independientemente del todo?", 
                opts: { a: "Composición", b: "Asociación", c: "Agregación" }, 
                ans: "c" 
            },
            { 
                q: "¿Cómo se llama la propiedad que permite a un objeto comportarse de diferentes maneras según su tipo real?", 
                opts: { a: "Encapsulamiento", b: "Polimorfismo", c: "Herencia" }, 
                ans: "b" 
            },
            { 
                q: "Si un 'Motor' no tiene sentido sin un 'Coche', ¿qué relación fuerte los une?", 
                opts: { a: "Asociación", b: "Composición", c: "Agregación" }, 
                ans: "b" 
            },
            { 
                q: "¿Qué indica la 'Cardinalidad' en una relación?", 
                opts: { a: "El color de la clase", b: "Cuántos objetos se relacionan", c: "La velocidad de la operación" }, 
                ans: "b" 
            },
            { 
                q: "El 'despacho dinámico' decide qué método ejecutar en...", 
                opts: { a: "Tiempo de compilación", b: "Tiempo de diseño", c: "Tiempo de ejecución" }, 
                ans: "c" 
            }
        ];

        let hits = 0;
        let summaryHTML = '<div class="swal-summary-list"><hr>';
        const optionLabels = { 'a': 'A', 'b': 'B', 'c': 'C' };

        for (let i = 0; i < questions.length; i++) {
            const { value: userAns } = await Swal.fire({
                title: `Pregunta ${i+1}/5`,
                text: questions[i].q,
                input: 'radio',
                inputOptions: questions[i].opts,
                inputValidator: (v) => !v && '¡Debes elegir una opción!',
                confirmButtonColor: '#b2d8d8'
            });

            const isCorrect = userAns === questions[i].ans;
            if (isCorrect) hits++;

            const correctOptionText = questions[i].opts[questions[i].ans]; // Texto de la opción correcta
            summaryHTML += `<p><strong>${isCorrect ? '✅ Correcto' : '❌ Incorrecto'} (P${i+1}):</strong> ${questions[i].q}<br><small class="text-success">Rpta correcta: <strong>${optionLabels[questions[i].ans]}.</strong> ${correctOptionText}</small></p>`;
        }
        
        summaryHTML += '</div>';

        Swal.fire({
            title: hits >= 3 ? '¡Excelente Trabajo!' : 'Buen intento',
            html: `<h4>Acertaste ${hits} de 5</h4>${summaryHTML}`,
            icon: hits >= 3 ? 'success' : 'info',
            confirmButtonText: 'Volver al Menú Principal',
            confirmButtonColor: '#b2d8d8',
            width: '600px'
        }).then(() => window.location.href = '../index.html'); // Regresa al menú principal
    }
</script>

</body>
</html>